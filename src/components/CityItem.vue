<template>
  <div :class="['city', `city--${icon}`]">
    <div class="city__header">
      <div class="city__temperature">
        <div class="city__degree">{{ temperature }}</div>
        <div class="city__celsius">°C</div>
      </div>
      <div class="city__wrap">
        <div class="city__name">{{ city.name }}</div>
        <div class="city__weather">{{ daytime }}. {{ currentWeather }}</div>
      </div>
    </div>
    <div class="city__details">
      <div class="city__item">
        <div class="city__icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 301.605 301.605">
            <path d="M236.896,38.375v12.854h-49.808V38.375H236.896z M216.009,66.389h-28.921v12.854h28.921V66.389z M187.088,107.257h49.808 V94.404h-49.808V107.257z M216.009,122.425h-28.921v12.854h28.921V122.425z M187.088,163.293h49.808v-12.854h-49.808V163.293z M194.852,236.533c0,35.881-29.191,65.072-65.072,65.072s-65.072-29.191-65.072-65.072c0-23.252,12.211-44.384,32.134-56.074 V32.938C96.843,14.775,111.618,0,129.78,0s32.938,14.775,32.938,32.938v147.522C182.641,192.137,194.852,213.275,194.852,236.533z M181.998,236.533c0-19.73-10.964-37.565-28.619-46.53l-3.515-1.787V32.944c0-11.08-9.01-20.084-20.084-20.084 c-11.073,0-20.084,9.004-20.084,20.084v155.272l-3.515,1.787c-17.655,8.972-28.619,26.806-28.619,46.53 c0,28.792,23.426,52.218,52.218,52.218S181.998,265.325,181.998,236.533z M171.291,236.533c0,22.886-18.619,41.505-41.511,41.505 c-22.886,0-41.505-18.619-41.505-41.505c0-18.76,12.674-35.232,30.823-40.058l2.384-0.636v-79.275h16.601v79.269l2.384,0.643 C158.624,201.301,171.291,217.78,171.291,236.533z M131.837,208.866c-0.99-4.396-5.411-7.288-9.917-6.26 c-15.733,3.56-26.723,17.32-26.723,33.465c0,4.569,3.721,8.291,8.291,8.291s8.291-3.721,8.291-8.291 c0-8.207,5.797-15.482,13.798-17.288C130.024,217.76,132.839,213.313,131.837,208.866z"/>
          </svg>
        </div>
        <div class="city__info">
          <div class="city__value">{{ feelsLike }}°</div>
          <div class="city__descr">Ощущается</div>
        </div>
      </div>
      <div class="city__item">
        <div class="city__icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 680.773 680.772">
            <path d="M290.861,277.837c-12.511-29.382-23.319-54.754-16.218-97.093c12.885-76.72,146.292-163.548,292.294-156.122 l1.231-24.152C407.374-7.549,265.429,88.59,250.636,176.771c-8.272,49.259,4.987,80.38,17.812,110.486 c9.661,22.691,19.66,46.143,21.278,79.196c2.56,51.94-155.265,135.109-255.34,175.323l9.13,22.401 c28.125-11.291,274.747-112.901,270.532-198.908C312.212,327.929,300.873,301.313,290.861,277.837z M645.698,447.013 c-5.036-67.06-40.419-131.655-89.569-164.562c-85.971-57.556-92.758-88.217-74.595-119.036 c41.808-70.924,149.938-71.962,149.938-71.962V67.288c0,0-122.03,0.954-170.928,83.93 c-35.999,61.07,19.311,108.807,82.771,151.292c43.196,28.922,74.015,86.345,78.52,146.304 c3.985,53.111-9.879,133.382-98.579,214.136l16.448,17.824C635.578,593.462,650.093,505.462,645.698,447.013z M300.402,615.283 l5.676,23.501c0.531-0.133,13.151-3.177,30.758-11.243l-10.192-21.955C311.391,612.578,300.51,615.247,300.402,615.283z M381.228,290.517c9.794,17.245,20.095,35.794,28.645,56.155l22.462-9.299c-9.069-21.604-19.744-40.854-29.913-58.727 L381.228,290.517z M373.282,169.525l-22.22-9.842c-5.036,11.207-7.487,22.426-7.487,34.309c0,11.727,2.439,23.959,7.45,37.449 l22.837-8.381c-3.997-10.748-5.941-20.252-5.941-29.068C367.92,185.562,369.671,177.568,373.282,169.525z M377.218,572.207 l16.594,17.68c17.257-15.965,31.071-34.453,41.083-54.995l-21.906-10.53C404.293,542.186,392.266,558.283,377.218,572.207z M451.222,401.764l-24.032,3.876c1.184,7.27,2.041,14.661,2.548,21.991c0.375,5.64,0.568,11.134,0.568,16.472 c0,7.656-0.387,15.24-1.159,22.534l24.213,2.524c0.857-8.14,1.292-16.557,1.292-25.059c0-5.857-0.205-11.883-0.628-18.103 C453.468,417.921,452.526,409.758,451.222,401.764z M421.611,87.54c-9.299,6.231-17.824,12.487-25.36,18.585l15.35,18.743 c6.979-5.628,14.938-11.46,23.633-17.306L421.611,87.54z"/>
          </svg>
        </div>
        <div class="city__info">
          <div class="city__value">{{ visibility }} км</div>
          <div class="city__descr">Видимость</div>
        </div>
      </div>
      <div class="city__item">
        <div class="city__icon">
          <svg viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
            <path d="M23.4761,13.9932,16.8472,3.4365a1.04,1.04,0,0,0-1.6944,0L8.4941,14.0444A9.9861,9.9861,0,0,0,7,19a9,9,0,0,0,18,0A10.0632,10.0632,0,0,0,23.4761,13.9932ZM16,26.0005a7.0089,7.0089,0,0,1-7-7,7.978,7.978,0,0,1,1.2183-3.9438l.935-1.4888L21.2271,23.6411A6.9772,6.9772,0,0,1,16,26.0005Z"/>
          </svg>
        </div>
        <div class="city__info">
          <div class="city__value">{{ city.main.humidity }}%</div>
          <div class="city__descr">Влажность</div>
        </div>
      </div>
      <div class="city__item">
        <div class="city__icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 516.4 516.4">
            <path d="M344.199,143.45c0-42.1-34.398-76.5-76.5-76.5c-42.099,0-76.499,34.4-76.499,76.5h38.2c0-21,17.2-38.2,38.2-38.2 c21,0,38.201,17.2,38.201,38.2s-17.201,38.2-38.201,38.2H38.2v38.2h229.499C309.801,220.05,344.199,185.55,344.199,143.45z"/>
            <path d="M439.801,143.45c-42.102,0-76.5,34.4-76.5,76.5H401.6c0-21,17.201-38.2,38.201-38.2S478,198.95,478,219.95 s-17.1,38.3-38.199,38.3H0v38.2h439.9c42.1,0,76.5-34.4,76.5-76.5C516.4,177.85,481.9,143.45,439.801,143.45z"/>
            <path d="M382.5,334.75H114.7v38.2h267.8c11.5,0,19.1,7.6,19.1,19.1s-7.6,19.101-19.1,19.101s-19.1-7.601-19.1-19.101h-38.201 c0,30.601,24.9,57.4,57.4,57.4s57.4-24.9,57.4-57.4S415,334.75,382.5,334.75z"/>
          </svg>
        </div>
        <div class="city__info">
          <div class="city__value">{{ wind }} м/с</div>
          <div class="city__descr">Скорость ветра</div>
        </div>
      </div>
    </div>
  </div>
</template>

<script lang="ts">
import { defineComponent, computed, PropType } from 'vue';
import { WeatherDetails } from '../types';

export default defineComponent({
  props: {
    city: {
      type: Object as PropType<WeatherDetails>,
      required: true
    }
  },
  setup(props) {
    const daytime = computed<string>(() => props.city.weather[0].icon.slice(2) === 'd' ? 'День' : 'Ночь' );
    const icon = computed<string>(() => props.city.weather[0].icon.slice(0, 2));
    const currentWeather = computed<string>(() => {
      const name = props.city.weather[0].description;
      return name[0].toUpperCase() + name.slice(1);
    });
    const temperature = computed<number>(() => Math.trunc(props.city.main.temp));
    const feelsLike = computed<number>(() => Math.trunc(props.city.main.feels_like));
    const visibility = computed<number>(() => Math.trunc(props.city.visibility / 1000));
    const wind = computed<number>(() => Math.trunc(props.city.wind.speed));

    return {
      daytime,
      icon,
      currentWeather,
      temperature,
      feelsLike,
      visibility,
      wind
    }
  }
});
</script>